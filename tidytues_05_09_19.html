<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>#TidyTuesday</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}

.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sarah Vititoe</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="cv.html">CV/Resume</a>
</li>
<li>
  <a href="projects.html">Projects</a>
</li>
<li>
  <a href="mailto:&lt;sarahvititoe23@gmail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/sarahvititoe/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/sarahvititoe/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">#TidyTuesday</h1>

</div>


<div id="may-7th-2019-global-student-to-teacher-ratios" class="section level3">
<h3>May 7th, 2019: Global Student to Teacher Ratios</h3>
<p>This week’s dataset is about student to teacher ratios. My mom has been a teacher for almost two decades now, at the high-school level, so this analysis is dedicated to her! <strong>Happy early mother’s day, mom!</strong> The official #TidyTuesday repository can be viewed <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-05-07">here</a>, and all code used to create these plots can be viewed <a href="tidytues_05_09_19.html">here</a>.</p>
<p>My mom has spent most of her time teaching at Palm Bay Magnet Senior High School in Melbourne, FL, but two years ago she and my dad moved to Dayton Ohio, and she currently teaches at Trotwood-Madison High School. I think it’d be interesting to see where the student to teacher ratio’s fall among these global averages that the #TidyTuesday project shared. I’m going to use data about student:teacher ratios, along with a few other tidbits that would be important to my mom to suggest the ideal country for her to move to.</p>
<p>First, I’m going to try to extract data from the US News and World Rankings for these two schools, so I can add them into our dataset.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.7
## ✔ tidyr   0.8.2     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(rvest)</code></pre>
<pre><code>## Loading required package: xml2</code></pre>
<pre><code>## 
## Attaching package: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     pluck</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<pre class="r"><code>library(httr)</code></pre>
<pre class="r"><code># create a tibble with our URLs for data
mom_hs &lt;- tibble(
  edulit_ind = c(&quot;pbhs&quot;, &quot;tmhs&quot;), 
  indicator = &quot;Secondary School&quot;, 
  country = c(&quot;Melbourne, FL, USA&quot;, &quot;Trotwood City, OH, USA&quot;),
  country_code = c(&quot;FLA&quot;, &quot;OHI&quot;),
  year = 2019, 
  url = c( &quot;https://www.usnews.com/education/best-high-schools/florida/districts/brevard-public-schools/palm-bay-magnet-senior-high-school-4695&quot;, &quot;https://www.usnews.com/education/best-high-schools/ohio/districts/trotwood-madison-city/trotwood-madison-high-school-15643&quot;), 
  flags = &quot;Data from US News and World Rankings&quot;, 
  mom_school = &quot;Yes&quot;) %&gt;% 
  group_by(edulit_ind, country, url) %&gt;% 
  nest() %&gt;% 
  # extract the nodes with the data for student ratios
  mutate(url = map(url, ~read_html(.))) %&gt;% 
  mutate(url = map(url, ~html_nodes(., &quot;.display-inline-for-small-only&quot;))) %&gt;% 
  mutate(url = map(url, ~html_text(.))) %&gt;% 
  mutate(url = map(url, ~as_tibble(.))) %&gt;% 
  mutate(url = map(url, ~filter(., str_detect(value, &quot;\\:&quot;)))) %&gt;% 
  unnest() %&gt;% 
  separate(value, into = c(&quot;student_ratio&quot;, &quot;student_ratio_denom&quot;), by = &quot;\\:&quot;) %&gt;% 
  mutate(student_ratio = as.numeric(student_ratio)) %&gt;% 
  select(-student_ratio_denom)</code></pre>
<p><a href="https://www.usnews.com/education/best-high-schools/florida/districts/brevard-public-schools/palm-bay-magnet-senior-high-school-4695">Palm Bay Magnent High School</a> has a student:teacher ratio of <strong>19:1</strong>, and <a href="https://www.usnews.com/education/best-high-schools/ohio/districts/trotwood-madison-city/trotwood-madison-high-school-15643">Trotwood Madison High School</a> has a student:teacher ratio of <strong>18:1</strong>.</p>
<p>Now, we’ll join the data from mom’s high school to the dataset from #TidyTuesday. We’ll also filter to get only secondary schools, and select only the data that’s the most recent. We also have quite a few data points that aren’t countries, but rather regions, so we’ll get rid of those too.</p>
<pre class="r"><code>student_ratio &lt;- read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-07/student_teacher_ratio.csv&quot;)

schools &lt;- student_ratio %&gt;% 
  mutate(mom_school = &quot;No&quot;) %&gt;% 
  select(-flag_codes) %&gt;% 
  union(mom_hs) %&gt;% 
  filter(str_detect(indicator, &quot;[Ss]econdary&quot;), str_detect(country_code, &quot;[A-Za-z][A-Za-z][A-Za-z]&quot;) == TRUE) %&gt;% 
  group_by(edulit_ind, indicator, country, country_code) %&gt;% 
  top_n(1, year) %&gt;% 

  group_by(country, country_code, mom_school) %&gt;% 
  summarise(student_ratio = as.numeric(mean(student_ratio, na.rm = TRUE)), student_ratio = round(student_ratio, 1)) %&gt;% 
  filter(!is.nan(student_ratio)) %&gt;% 
  ungroup()</code></pre>
<p>And now we have a map of student-teacher ratios! Every country is represented by their two-digit country code, while PBMHS is represented by the code “FL”, and TMHS is represented by the code “OH”. Tile location approximates country/school geography.</p>
<pre class="r"><code>world &lt;- read_csv(&quot;./portfolio/tidy tuesday/worldtilegrid.csv&quot;) %&gt;% 
  add_row(alpha.2 = &quot;OH&quot;, alpha.3 = &quot;OHI&quot;, x = 2, y = 1, region = &quot;Americas&quot;, sub.region = &quot;Northern America&quot;) %&gt;% 
  add_row(alpha.2 = &quot;FL&quot;, alpha.3 = &quot;FLA&quot;, x = 2, y = 2, region = &quot;Americas&quot;, sub.region = &quot;Northwen America&quot;) %&gt;% 
  select(alpha.2, alpha.3, x, y, region, sub.region) %&gt;% 
  inner_join(schools, by = c(&quot;alpha.3&quot; = &quot;country_code&quot;)) %&gt;% 
  mutate(alpha.2 = ifelse(is.na(alpha.2) == TRUE, &quot;NA&quot;, alpha.2))

map &lt;-png::readPNG(&quot;./portfolio/tidy tuesday/world_outline.png&quot;)

ggplot(world, aes(xmin = x, ymin = y, xmax = x + 1, ymax = y + 1, fill = student_ratio)) +
  annotation_custom(grid::rasterGrob(map, 
                                 width = unit(1,&quot;npc&quot;), 
                                 height = unit(1,&quot;npc&quot;)), 
                      -Inf, Inf, -Inf, Inf) +
  geom_rect(color = &quot;white&quot;) +
  theme_minimal() +
  theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), legend.position = &quot;bottom&quot;) +
  geom_text(aes(x = x, y = y, label = alpha.2), color = &quot;white&quot;,  nudge_x = 0.5, nudge_y = -0.5, size = 3) +
  scale_y_reverse() + 
  viridis::scale_fill_viridis(option = &quot;inferno&quot;, end = .9, trans = &quot;log&quot;, name = &quot;Student to Teacher Ratio&quot;, breaks = c(6, 17, 40, 90), labels = c(&quot;6:1&quot;, &quot;17:1&quot;, &quot;40:1&quot;, &quot;90:1&quot;), direction = -1)</code></pre>
<p><img src="tidytues_05_09_19_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Since there are 130 countries with a student ratio that’s at least as good as her current skills, we need to narrow down my mom’s options a little bit more. Knowing my mom, she’ll want to live somewhere that’s relatively close to family. My little sister is hoping to move to Germany, my brother and quite a few other family members live in Illinois, and I’ll be living in Califonia soon, and we have family and friends in Florida. Keeping that in mind, let’s limit our search to Europe (except for Northern-Europe - too cold!), North America, Central America, and the Caribbean, and have a student teacher ratio as good or better than 19:1.</p>
<pre class="r"><code>world %&gt;% 
  filter(region %in% c(&quot;Americas&quot;, &quot;Europe&quot;), sub.region != &quot;South America&quot;, sub.region != &quot;Northern Europe&quot;, student_ratio &lt;= 19) %&gt;% 
  arrange(student_ratio) %&gt;% 
  mutate(country = reorder(country, student_ratio)) %&gt;% 
  ggplot(aes(x=country, y=student_ratio)) +
    geom_segment( aes(x=country ,xend=country, y=0, yend = student_ratio), color=&quot;grey&quot;) +
    geom_point(size=3, aes(color = mom_school)) +
    coord_flip() +
    theme_minimal() + 
    theme(
      panel.grid.minor.y = element_blank(),
      panel.grid.major.y = element_blank(),
      legend.position=&quot;none&quot;
    ) + 
  viridis::scale_color_viridis(discrete = TRUE, begin = .5, end = .8, option = &quot;inferno&quot;) +
  labs(y  = &quot;Students per Teacher in Secondary Schools&quot;, x = &quot;&quot;)</code></pre>
<p><img src="tidytues_05_09_19_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Here you go mom! Hope this gives you some ideas next time you’re brainstorming a dream country to move to!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
